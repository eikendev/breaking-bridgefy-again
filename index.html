<!doctype html><html lang=en-us dir=ltr class=h-100 itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Raphael Eikenberg, Martin R. Albrecht, Kenneth G. Paterson"><meta name=description content="In this work, we analyse the revised security architecture of Bridgefy and report severe vulnerabilities. We show that an adversary can compromise the confidentiality of one-to-one messages by using a TOCTOU attack side-stepping Signal's guarantees. Further, we show that an adversary can impersonate other users in the broadcast channel. Finally, we show that any nodes in the network that receive a single carefully crafted message become unable to participate in further network communication."><meta name=keywords content="bridgefy,cryptography,toctou,libsignal,ethz"><meta property="og:title" content="Breaking Bridgefy, again"><meta property="og:description" content="In this work, we analyse the revised security architecture of Bridgefy and report severe vulnerabilities. We show that an adversary can compromise the confidentiality of one-to-one messages by using a TOCTOU attack side-stepping Signal's guarantees. Further, we show that an adversary can impersonate other users in the broadcast channel. Finally, we show that any nodes in the network that receive a single carefully crafted message become unable to participate in further network communication."><meta property="og:type" content="website"><meta property="og:url" content="https://eikendev.github.io/breaking-bridgefy-again/"><meta property="og:image" content="https://eikendev.github.io/breaking-bridgefy-again/img/card.png"><meta property="og:site_name" content="Breaking Bridgefy, again"><meta itemprop=name content="Breaking Bridgefy, again"><meta itemprop=description content="In this work, we analyse the revised security architecture of Bridgefy and report severe vulnerabilities. We show that an adversary can compromise the confidentiality of one-to-one messages by using a TOCTOU attack side-stepping Signal's guarantees. Further, we show that an adversary can impersonate other users in the broadcast channel. Finally, we show that any nodes in the network that receive a single carefully crafted message become unable to participate in further network communication."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://eikendev.github.io/breaking-bridgefy-again/img/card.png"><meta name=twitter:title content="Breaking Bridgefy, again"><meta name=twitter:description content="In this work, we analyse the revised security architecture of Bridgefy and report severe vulnerabilities. We show that an adversary can compromise the confidentiality of one-to-one messages by using a TOCTOU attack side-stepping Signal's guarantees. Further, we show that an adversary can impersonate other users in the broadcast channel. Finally, we show that any nodes in the network that receive a single carefully crafted message become unable to participate in further network communication."><meta name=twitter:site content="@eikendev"><meta name=twitter:creator content="@eikendev"><title>Breaking Bridgefy, again</title><link rel=canonical href=https://eikendev.github.io/breaking-bridgefy-again/><link rel=apple-touch-icon sizes=180x180 href=https://eikendev.github.io/breaking-bridgefy-again/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://eikendev.github.io/breaking-bridgefy-again/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://eikendev.github.io/breaking-bridgefy-again/favicon-16x16.png><link rel=manifest href=https://eikendev.github.io/breaking-bridgefy-again/site.webmanifest><link rel=mask-icon href=https://eikendev.github.io/breaking-bridgefy-again/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#000000"><meta name=theme-color content="#000000"><link rel=stylesheet href=https://eikendev.github.io/breaking-bridgefy-again/css/style.c91b245276c2087985a03c4ea8dd414427b2232fe45caf57becce2b1417e4bbedfaed9b531973ad5a80ebf55fec24cee.css integrity=sha384-yRskUnbCCHmFoDxOqN1BRCeyIy/kXK9XvszisUF+S77frtm1MZc61agOv1X+wkzu></head><body class="d-flex flex-column h-100"><header class="jumbotron text-center pt-5 mb-0"><div class=container><div class=py-lg-5><h1>Breaking Bridgefy, again</h1><h2>Adopting libsignal is not enough</h2><p class="lead text-muted">We analysed the Bridgefy messaging application and found that your private messages are <em>not</em> safe.</p><div class=mt-4><a href=./breaking-bridgefy-again.pdf class="btn btn-primary my-2 mx-2"><i class="fab fa-readme fa-lg me-2"></i>Read the Paper</a><a href=#faq class="btn btn-secondary my-2 mx-2"><i class="fas fa-lightbulb fa-lg me-2"></i>FAQ</a><a href=#contact class="btn btn-secondary my-2 mx-2"><i class="fas fa-users fa-lg me-2"></i>Contact Us</a></div></div></div></header><main class=flex-shrink-0><section class=py-5 id=faq><div class=container><div id=content><div class="card my-3"><div class=card-header><strong>What is Bridgefy?</strong></div><div class=card-body>Bridgefy is a messaging application that uses Bluetooth to transmit messages, so that no Internet is required.
Its developers (<a href=https://twitter.com/bridgefy/status/1356750830955884552>1</a>, <a href=https://twitter.com/bridgefy/status/1371507779299590144>2</a>, <a href=https://twitter.com/bridgefy/status/1356680753338318859>3</a>, <a href=https://twitter.com/bridgefy/status/1359200080700600322>4</a>, <a href=https://twitter.com/bridgefy/status/1197191632665415686>5</a>, <a href=https://twitter.com/bridgefy/status/1216473058753597453>6</a>, <a href=https://twitter.com/bridgefy/status/1268015807252004864>7</a>) and others (<a href=https://www.reuters.com/article/amp/idUSKBN2A22H0>Reuters</a>, <a href=https://web.archive.org/web/20200411154603/https://www.forbes.com/sites/johnkoetsier/2019/09/02/hong-kong-protestors-using-mesh-messaging-app-china-cant-block-usage-up-3685/>Forbes</a>) have advertised it for use in areas witnessing large-scale protests and often violent confrontations between protesters and agents of the state.
After <a href=https://martinralbrecht.wordpress.com/2020/08/24/mesh-messaging-in-large-scale-protests-breaking-bridgefy/>a security analysis in August 2020</a> by Martin R. Albrecht, Jorge Blasco, Rikke Bjerg Jensen, and Lenka Marekov√° reported severe vulnerabilities, the Bridgefy developers adopted the Signal protocol.
The Bridgefy developers then continued to advertise their application as being suitable for use by higher-risk users, for example during the Russian invasion of Ukraine in 2022 (<a href=https://web.archive.org/web/20220302102610/https://twitter.com/bridgefy/status/1495805167920365574>8</a>, <a href=https://web.archive.org/web/20220302102616/https://twitter.com/bridgefy/status/1496981656867016704>9</a>, <a href=https://web.archive.org/web/20220302102619/https://twitter.com/bridgefy/status/1496876534732398593>10</a>, <a href=https://web.archive.org/web/20220302102345/https://twitter.com/bridgefy/status/1498708149083201544>11</a>).</div></div><div class="card my-3"><div class=card-header><strong>Results</strong></div><div class=card-body><p>In this work, we analyse the revised security architecture of Bridgefy and report several vulnerabilities.
The headline news is that we found a practical attack, with a proof-of-concept implementation, that breaks confidentiality of libsignal-protected private messages and succeeds with a probability of about 50%.
Please note that <strong>this attack in no way threatens Signal or libsignal</strong> but attacks how Bridgefy uses it.</p><p>Our other findings include:</p><ol><li>Bridgefy users can still be tracked.</li><li>Broadcast messages remain unauthenticated; an attacker can exploit this to mount impersonation attacks.</li><li>The protocol remains susceptible to an attacker in the middle. While such an attack is now limited to the first exchange between a pair of users (i.e., it abuses a &ldquo;trust on first use&rdquo; or TOFU assumption) we note that Bridgefy offers users no option to verify the public keys of their contacts.</li><li>Any nodes in the network that receive a single carefully crafted message become unable to participate in further network communication.</li><li>The broadcast encryption mechanism employed by the Bridgefy SDK is susceptible to a ciphertext-only attack with the assumption of plaintexts from a small domain. The Bridgefy messenger not affected by this.</li></ol></div></div><div class="card my-3"><div class=card-header><strong>Disclosure</strong></div><div class=card-body><p>We disclosed our first vulnerabilities to Bridgefy in May 2021.
According to the developers, the vulnerability allowing an attacker to read encrypted messages was fixed on 14 August 2021.
The disclosure of our attacks on the broadcast encryption followed in September 2021.
We asked the developers to comment on the remediation progress in early February 2022, however, at the time of writing the state of the remediation remains unclear.</p><p>We recommend that users avoid Bridgefy until its developers have committed to regular public security audits by respected third party auditors.</p></div></div><div class="card my-3"><div class=card-header><strong>Paper</strong></div><div class=card-body>You can find more details in <a href=./breaking-bridgefy-again.pdf>our research paper</a> which we presented at <a href=https://www.usenix.org/conference/usenixsecurity22/presentation/albrecht>the 31st USENIX Security Symposium</a>.</div></div><div class="card my-3"><div class=card-header><strong>Demo</strong></div><div class=card-body>A video demo of the TOCTOU attack can be found <a href=https://twitter.com/eikendev/status/1427542406262575105>here on Twitter</a>.</div></div><div class="card my-3"><div class=card-header><strong>Exploit Code</strong></div><div class=card-body>The source code for our attacks is available <a href=https://github.com/eikendev/breaking-bridgefy-again>here on GitHub</a>.</div></div><div class="card my-3" id=contact><div class=card-header><strong>Team</strong></div><div class=card-body><p>We are academic researchers from ETH Zurich and Royal Holloway:</p><ul><li><a href=https://malb.io/>Martin R. Albrecht</a> (Information Security Group, Royal Holloway, University of London)</li><li><a href=https://www.eiken.dev/>Raphael Eikenberg</a> (Applied Cryptography Group, ETH Zurich)</li><li><a href=https://inf.ethz.ch/people/person-detail.paterson.html>Kenneth G. Paterson</a> (Applied Cryptography Group, ETH Zurich)</li></ul></div></div></div></div></section></main><footer class="footer mt-auto py-3 bg-dark"><div class=container><div class="row justify-content-center mb-3"><a class="my-1 me-3 col-auto mr-clear-lastchild text-white" href=https://twitter.com/martinralbrecht title="martinralbrecht on Twitter"><i class="fab fa-twitter me-2"></i>martinralbrecht</a>
<a class="my-1 me-3 col-auto mr-clear-lastchild text-white" href=https://twitter.com/eikendev title="eikendev on Twitter"><i class="fab fa-twitter me-2"></i>eikendev</a>
<a class="my-1 me-3 col-auto mr-clear-lastchild text-white" href=https://twitter.com/kennyog title="kennyog on Twitter"><i class="fab fa-twitter me-2"></i>kennyog</a></div><p class="text-center text-muted"><a class="text-center text-muted" href=https://creativecommons.org/licenses/by/4.0/ title=License><small>Attribution 4.0 International (CC BY 4.0)</small></a></p></div></footer><script src=https://eikendev.github.io/breaking-bridgefy-again/js/bundle.min.89bf08928e5747ed21b041f5261f06bfcce04123f9971c4a594c2aaf2cd58ccc339aa8b05de4dc4d358a4048a548937b.js integrity=sha384-ib8Iko5XR+0hsEH1Jh8Gv8zgQSP5lxxKWUwqryzVjMwzmqiwXeTcTTWKQEilSJN7 crossorigin=anonymous></script>
<script defer src=https://eikendev.github.io/breaking-bridgefy-again/js/bundle-deferred.min.f670b8104fba93e6cf8fd6d1e1090051a6503fa9da040abbd3f531a90c8b383975785b7a174f5fb18e59bde10a2309a1.js integrity=sha384-9nC4EE+6k+bPj9bR4QkAUaZQP6naBAq70/UxqQyLODl1eFt6F09fsY5ZveEKIwmh crossorigin=anonymous></script></body></html>